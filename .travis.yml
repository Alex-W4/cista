dist: xenial
sudo: require
language: cpp
compiler: clang
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
      - llvm-toolchain-xenial-7
    packages:
      - cmake
      - clang-7
      - libc++-7-dev
      - libc++abi-7-dev
env:
  BUILD_TYPE=Release CC=clang-7 CXX=clang++-7 CXXFLAGS="-std=c++17 -stdlib=libc++ -D_LIBCPP_VERSION=1"
  BUILD_TYPE=Debug   CC=clang-7 CXX=clang++-7 CXXFLAGS="-std=c++17 -stdlib=libc++ -D_LIBCPP_VERSION=1 -fno-omit-frame-pointer -fsanitize=address -fsanitize=undefined"
script:
  - export CC=clang-7
  - export CXX=clang++-7
  - export CXXFLAGS="-std=c++17 -stdlib=libc++ -D_LIBCPP_VERSION=1"
  - export LDFLAGS="-stdlib=libc++"
  - mkdir build && cd build
  - cmake -DCMAKE_BUILD_TYPE=$BUILD_TYPE ..
  - make cista-format-check
  - make cista-test
  - ./cista-test
